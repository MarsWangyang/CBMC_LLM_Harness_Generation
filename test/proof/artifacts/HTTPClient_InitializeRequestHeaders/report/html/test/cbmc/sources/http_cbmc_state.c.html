
<html>
<head>
<title>test/cbmc/sources/http_cbmc_state.c</title>
<link rel="stylesheet" type="text/css" href="../../../viewer.css">
</head>

<body>
<div class="code">
<div id="1" class="line none">    1 /*</div><div id="2" class="line none">    2  * coreHTTP v3.1.1</div><div id="3" class="line none">    3  * Copyright (C) 2024 Amazon.com, Inc. or its affiliates.  All Rights Reserved.</div><div id="4" class="line none">    4  *</div><div id="5" class="line none">    5  * SPDX-License-Identifier: MIT</div><div id="6" class="line none">    6  *</div><div id="7" class="line none">    7  * Permission is hereby granted, free of charge, to any person obtaining a copy of</div><div id="8" class="line none">    8  * this software and associated documentation files (the "Software"), to deal in</div><div id="9" class="line none">    9  * the Software without restriction, including without limitation the rights to</div><div id="10" class="line none">   10  * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of</div><div id="11" class="line none">   11  * the Software, and to permit persons to whom the Software is furnished to do so,</div><div id="12" class="line none">   12  * subject to the following conditions:</div><div id="13" class="line none">   13  *</div><div id="14" class="line none">   14  * The above copyright notice and this permission notice shall be included in all</div><div id="15" class="line none">   15  * copies or substantial portions of the Software.</div><div id="16" class="line none">   16  *</div><div id="17" class="line none">   17  * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</div><div id="18" class="line none">   18  * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS</div><div id="19" class="line none">   19  * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR</div><div id="20" class="line none">   20  * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER</div><div id="21" class="line none">   21  * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN</div><div id="22" class="line none">   22  * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</div><div id="23" class="line none">   23  */</div><div id="24" class="line none">   24 </div><div id="25" class="line none">   25 /**</div><div id="26" class="line none">   26  * @file http_cbmc_state.c</div><div id="27" class="line none">   27  * @brief Implements the functions in http_cbmc_state.h.</div><div id="28" class="line none">   28  */</div><div id="29" class="line none">   29 </div><div id="30" class="line none">   30 #include &lt;stdlib.h&gt;</div><div id="31" class="line none">   31 </div><div id="32" class="line none">   32 #include "http_cbmc_state.h"</div><div id="33" class="line none">   33 </div><div id="34" class="line none">   34 void * <a href="http_cbmc_state.c.html#34">mallocCanFail</a>( size_t size )</div><div id="35" class="line none">   35 {</div><div id="36" class="line hit">   36     __CPROVER_assert( size &lt; CBMC_MAX_OBJECT_SIZE, "mallocCanFail size is too big" );</div><div id="37" class="line hit">   37     return malloc( size );</div><div id="38" class="line hit">   38 }</div><div id="39" class="line none">   39 </div><div id="40" class="line none">   40 <a href="../../../source/include/core_http_client.h.html#389">HTTPRequestHeaders_t</a> * <a href="http_cbmc_state.c.html#40">allocateHttpRequestHeaders</a>( <a href="../../../source/include/core_http_client.h.html#389">HTTPRequestHeaders_t</a> * pRequestHeaders )</div><div id="41" class="line none">   41 {</div><div id="42" class="line hit">   42     if( pRequestHeaders == NULL )</div><div id="43" class="line none">   43     {</div><div id="44" class="line hit">   44         pRequestHeaders = <a href="http_cbmc_state.c.html#34">mallocCanFail</a>( sizeof( <a href="../../../source/include/core_http_client.h.html#389">HTTPRequestHeaders_t</a> ) );</div><div id="45" class="line none">   45     }</div><div id="46" class="line none">   46 </div><div id="47" class="line hit">   47     if( pRequestHeaders != NULL )</div><div id="48" class="line none">   48     {</div><div id="49" class="line hit">   49         __CPROVER_assume( pRequestHeaders-&gt;<a href="../../../source/include/core_http_client.h.html#381">bufferLen</a> &lt; CBMC_MAX_OBJECT_SIZE );</div><div id="50" class="line hit">   50         pRequestHeaders-&gt;<a href="../../../source/include/core_http_client.h.html#380">pBuffer</a> = <a href="http_cbmc_state.c.html#34">mallocCanFail</a>( pRequestHeaders-&gt;<a href="../../../source/include/core_http_client.h.html#381">bufferLen</a> );</div><div id="51" class="line none">   51     }</div><div id="52" class="line none">   52 </div><div id="53" class="line hit">   53     return pRequestHeaders;</div><div id="54" class="line hit">   54 }</div><div id="55" class="line none">   55 </div><div id="56" class="line none">   56 bool <a href="http_cbmc_state.c.html#56">isValidHttpRequestHeaders</a>( const <a href="../../../source/include/core_http_client.h.html#389">HTTPRequestHeaders_t</a> * pRequestHeaders )</div><div id="57" class="line none">   57 {</div><div id="58" class="line hit">   58     bool isValid = true;</div><div id="59" class="line none">   59 </div><div id="60" class="line hit">   60     if( pRequestHeaders )</div><div id="61" class="line none">   61     {</div><div id="62" class="line hit">   62         isValid = pRequestHeaders-&gt;<a href="../../../source/include/core_http_client.h.html#381">bufferLen</a> &lt; CBMC_MAX_OBJECT_SIZE &amp;&amp;</div><div id="63" class="line hit">   63                   pRequestHeaders-&gt;<a href="../../../source/include/core_http_client.h.html#388">headersLen</a> &lt; CBMC_MAX_OBJECT_SIZE;</div><div id="64" class="line none">   64     }</div><div id="65" class="line none">   65 </div><div id="66" class="line hit">   66     return isValid;</div><div id="67" class="line hit">   67 }</div><div id="68" class="line none">   68 </div><div id="69" class="line none">   69 <a href="../../../source/include/core_http_client.h.html#423">HTTPRequestInfo_t</a> * <a href="http_cbmc_state.c.html#69">allocateHttpRequestInfo</a>( <a href="../../../source/include/core_http_client.h.html#423">HTTPRequestInfo_t</a> * pRequestInfo )</div><div id="70" class="line none">   70 {</div><div id="71" class="line hit">   71     if( pRequestInfo == NULL )</div><div id="72" class="line none">   72     {</div><div id="73" class="line hit">   73         pRequestInfo = <a href="http_cbmc_state.c.html#34">mallocCanFail</a>( sizeof( <a href="../../../source/include/core_http_client.h.html#423">HTTPRequestInfo_t</a> ) );</div><div id="74" class="line none">   74     }</div><div id="75" class="line none">   75 </div><div id="76" class="line hit">   76     if( pRequestInfo != NULL )</div><div id="77" class="line none">   77     {</div><div id="78" class="line hit">   78         __CPROVER_assume( pRequestInfo-&gt;<a href="../../../source/include/core_http_client.h.html#401">methodLen</a> &lt; CBMC_MAX_OBJECT_SIZE );</div><div id="79" class="line hit">   79         pRequestInfo-&gt;<a href="../../../source/include/core_http_client.h.html#400">pMethod</a> = <a href="http_cbmc_state.c.html#34">mallocCanFail</a>( pRequestInfo-&gt;<a href="../../../source/include/core_http_client.h.html#401">methodLen</a> );</div><div id="80" class="line none">   80 </div><div id="81" class="line hit">   81         __CPROVER_assume( pRequestInfo-&gt;<a href="../../../source/include/core_http_client.h.html#415">hostLen</a> &lt; CBMC_MAX_OBJECT_SIZE );</div><div id="82" class="line hit">   82         pRequestInfo-&gt;<a href="../../../source/include/core_http_client.h.html#414">pHost</a> = <a href="http_cbmc_state.c.html#34">mallocCanFail</a>( pRequestInfo-&gt;<a href="../../../source/include/core_http_client.h.html#415">hostLen</a> );</div><div id="83" class="line none">   83 </div><div id="84" class="line hit">   84         __CPROVER_assume( pRequestInfo-&gt;<a href="../../../source/include/core_http_client.h.html#407">pathLen</a> &lt; CBMC_MAX_OBJECT_SIZE );</div><div id="85" class="line hit">   85         pRequestInfo-&gt;<a href="../../../source/include/core_http_client.h.html#406">pPath</a> = <a href="http_cbmc_state.c.html#34">mallocCanFail</a>( pRequestInfo-&gt;<a href="../../../source/include/core_http_client.h.html#407">pathLen</a> );</div><div id="86" class="line none">   86     }</div><div id="87" class="line none">   87 </div><div id="88" class="line hit">   88     return pRequestInfo;</div><div id="89" class="line hit">   89 }</div><div id="90" class="line none">   90 </div><div id="91" class="line none">   91 bool <a href="http_cbmc_state.c.html#91">isValidHttpRequestInfo</a>( const <a href="../../../source/include/core_http_client.h.html#423">HTTPRequestInfo_t</a> * pRequestInfo )</div><div id="92" class="line none">   92 {</div><div id="93" class="line hit">   93     bool isValid = true;</div><div id="94" class="line none">   94 </div><div id="95" class="line hit">   95     if( pRequestInfo )</div><div id="96" class="line none">   96     {</div><div id="97" class="line hit">   97         isValid = ( pRequestInfo-&gt;<a href="../../../source/include/core_http_client.h.html#401">methodLen</a> &lt; CBMC_MAX_OBJECT_SIZE ) &amp;&amp;</div><div id="98" class="line hit">   98                   ( pRequestInfo-&gt;<a href="../../../source/include/core_http_client.h.html#415">hostLen</a> &lt; CBMC_MAX_OBJECT_SIZE ) &amp;&amp;</div><div id="99" class="line hit">   99                   ( pRequestInfo-&gt;<a href="../../../source/include/core_http_client.h.html#407">pathLen</a> &lt; CBMC_MAX_OBJECT_SIZE );</div><div id="100" class="line none">  100     }</div><div id="101" class="line none">  101 </div><div id="102" class="line hit">  102     return isValid;</div><div id="103" class="line hit">  103 }</div><div id="104" class="line none">  104 </div><div id="105" class="line none">  105 <a href="../../../source/include/core_http_client.h.html#584">HTTPResponse_t</a> * <a href="http_cbmc_state.c.html#105">allocateHttpResponse</a>( <a href="../../../source/include/core_http_client.h.html#584">HTTPResponse_t</a> * <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a> )</div><div id="106" class="line none">  106 {</div><div id="107" class="line none">  107     size_t headerOffset, bodyOffset;</div><div id="108" class="line none">  108 </div><div id="109" class="line none">  109     if( <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a> == NULL )</div><div id="110" class="line none">  110     {</div><div id="111" class="line none">  111         <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a> = <a href="http_cbmc_state.c.html#34">mallocCanFail</a>( sizeof( <a href="../../../source/include/core_http_client.h.html#584">HTTPResponse_t</a> ) );</div><div id="112" class="line none">  112     }</div><div id="113" class="line none">  113 </div><div id="114" class="line none">  114     if( <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a> != NULL )</div><div id="115" class="line none">  115     {</div><div id="116" class="line none">  116         __CPROVER_assume( <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#381">bufferLen</a> &lt; CBMC_MAX_OBJECT_SIZE );</div><div id="117" class="line none">  117         <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#380">pBuffer</a> = <a href="http_cbmc_state.c.html#34">mallocCanFail</a>( <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#381">bufferLen</a> );</div><div id="118" class="line none">  118 </div><div id="119" class="line none">  119         __CPROVER_assume( headerOffset &lt;= <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#381">bufferLen</a> );</div><div id="120" class="line none">  120 </div><div id="121" class="line none">  121         if( <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#380">pBuffer</a> != NULL )</div><div id="122" class="line none">  122         {</div><div id="123" class="line none">  123             /* It is possible to have no headers in the response so set to NULL or</div><div id="124" class="line none">  124              * an offset in the response buffer. */</div><div id="125" class="line none">  125             <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#517">pHeaders</a> = <a href="../include/http_cbmc_state.h.html#49">nondet_bool</a>() ? NULL :</div><div id="126" class="line none">  126                                   <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#380">pBuffer</a> + headerOffset;</div><div id="127" class="line none">  127         }</div><div id="128" class="line none">  128 </div><div id="129" class="line none">  129         if( <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#517">pHeaders</a> != NULL )</div><div id="130" class="line none">  130         {</div><div id="131" class="line none">  131             /* The length of the headers MUST be between the start of the</div><div id="132" class="line none">  132              * headers and the end of the buffer. */</div><div id="133" class="line none">  133             __CPROVER_assume( <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#388">headersLen</a> &lt; ( <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#381">bufferLen</a> - headerOffset ) );</div><div id="134" class="line none">  134         }</div><div id="135" class="line none">  135 </div><div id="136" class="line none">  136         if( <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#381">bufferLen</a> == 0 )</div><div id="137" class="line none">  137         {</div><div id="138" class="line none">  138             bodyOffset = 0;</div><div id="139" class="line none">  139         }</div><div id="140" class="line none">  140         else</div><div id="141" class="line none">  141         {</div><div id="142" class="line none">  142             __CPROVER_assume( bodyOffset &lt;= <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#381">bufferLen</a> );</div><div id="143" class="line none">  143         }</div><div id="144" class="line none">  144 </div><div id="145" class="line none">  145         if( <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#380">pBuffer</a> != NULL )</div><div id="146" class="line none">  146         {</div><div id="147" class="line none">  147             <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#531">pBody</a> = <a href="../include/http_cbmc_state.h.html#49">nondet_bool</a>() ? NULL :</div><div id="148" class="line none">  148                                <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#380">pBuffer</a> + bodyOffset;</div><div id="149" class="line none">  149         }</div><div id="150" class="line none">  150 </div><div id="151" class="line none">  151         /* The length of the body MUST be between the start of body and the end</div><div id="152" class="line none">  152          * of the buffer. */</div><div id="153" class="line none">  153         if( <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#531">pBody</a> )</div><div id="154" class="line none">  154         {</div><div id="155" class="line none">  155             __CPROVER_assume( <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#538">bodyLen</a> &lt; ( <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#381">bufferLen</a> - bodyOffset ) );</div><div id="156" class="line none">  156         }</div><div id="157" class="line none">  157     }</div><div id="158" class="line none">  158 </div><div id="159" class="line none">  159     return <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>;</div><div id="160" class="line none">  160 }</div><div id="161" class="line none">  161 </div><div id="162" class="line none">  162 bool <a href="http_cbmc_state.c.html#162">isValidHttpResponse</a>( const <a href="../../../source/include/core_http_client.h.html#584">HTTPResponse_t</a> * <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a> )</div><div id="163" class="line none">  163 {</div><div id="164" class="line none">  164     bool isValid = true;</div><div id="165" class="line none">  165 </div><div id="166" class="line none">  166     if( <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a> )</div><div id="167" class="line none">  167     {</div><div id="168" class="line none">  168         isValid = ( <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#381">bufferLen</a> &lt; CBMC_MAX_OBJECT_SIZE ) &amp;&amp;</div><div id="169" class="line none">  169                   ( <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#538">bodyLen</a> &lt; <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#381">bufferLen</a> ) &amp;&amp;</div><div id="170" class="line none">  170                   ( <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#388">headersLen</a> &lt; <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#381">bufferLen</a> );</div><div id="171" class="line none">  171         isValid = isValid || <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#531">pBody</a> == NULL;</div><div id="172" class="line none">  172     }</div><div id="173" class="line none">  173 </div><div id="174" class="line none">  174     return isValid;</div><div id="175" class="line none">  175 }</div><div id="176" class="line none">  176 </div><div id="177" class="line none">  177 <a href="../../../source/interface/transport_interface.h.html#304">TransportInterface_t</a> * <a href="http_cbmc_state.c.html#177">allocateTransportInterface</a>( <a href="../../../source/interface/transport_interface.h.html#304">TransportInterface_t</a> * pTransport )</div><div id="178" class="line none">  178 {</div><div id="179" class="line none">  179     if( pTransport == NULL )</div><div id="180" class="line none">  180     {</div><div id="181" class="line none">  181         pTransport = <a href="http_cbmc_state.c.html#34">mallocCanFail</a>( sizeof( <a href="../../../source/interface/transport_interface.h.html#304">TransportInterface_t</a> ) );</div><div id="182" class="line none">  182     }</div><div id="183" class="line none">  183 </div><div id="184" class="line none">  184     if( pTransport != NULL )</div><div id="185" class="line none">  185     {</div><div id="186" class="line none">  186         pTransport-&gt;<a href="../../../source/interface/transport_interface.h.html#303">pNetworkContext</a> = <a href="http_cbmc_state.c.html#34">mallocCanFail</a>( sizeof( <a href="../../../source/interface/transport_interface.h.html#191">NetworkContext_t</a> ) );</div><div id="187" class="line none">  187     }</div><div id="188" class="line none">  188 </div><div id="189" class="line none">  189     return pTransport;</div><div id="190" class="line none">  190 }</div><div id="191" class="line none">  191 </div><div id="192" class="line none">  192 bool <a href="http_cbmc_state.c.html#192">isValidTransportInterface</a>( <a href="../../../source/interface/transport_interface.h.html#304">TransportInterface_t</a> * pTransportInterface )</div><div id="193" class="line none">  193 {</div><div id="194" class="line none">  194     bool isValid = true;</div><div id="195" class="line none">  195 </div><div id="196" class="line none">  196     if( pTransportInterface )</div><div id="197" class="line none">  197     {</div><div id="198" class="line none">  198         isValid = isValid &amp;&amp; ( pTransportInterface-&gt;<a href="../../../source/interface/transport_interface.h.html#301">send</a> == <a href="../include/transport_interface_stubs.h.html#51">TransportInterfaceSendStub</a> ||</div><div id="199" class="line none">  199                                pTransportInterface-&gt;<a href="../../../source/interface/transport_interface.h.html#301">send</a> == NULL );</div><div id="200" class="line none">  200         isValid = isValid &amp;&amp; ( pTransportInterface-&gt;<a href="../../../source/interface/transport_interface.h.html#300">recv</a> == <a href="../include/transport_interface_stubs.h.html#64">TransportInterfaceReceiveStub</a> ||</div><div id="201" class="line none">  201                                pTransportInterface-&gt;<a href="../../../source/interface/transport_interface.h.html#300">recv</a> == NULL );</div><div id="202" class="line none">  202     }</div><div id="203" class="line none">  203 }</div><div id="204" class="line none">  204 </div><div id="205" class="line none">  205 <a href="../../../source/dependency/3rdparty/llhttp/include/llhttp.h.html#324">llhttp_t</a> * <a href="http_cbmc_state.c.html#205">allocateHttpSendParser</a>( <a href="../../../source/dependency/3rdparty/llhttp/include/llhttp.h.html#324">llhttp_t</a> * pHttpParser )</div><div id="206" class="line none">  206 {</div><div id="207" class="line none">  207     <a href="../../../source/include/core_http_client_private.h.html#308">HTTPParsingContext_t</a> * pHttpParsingContext;</div><div id="208" class="line none">  208 </div><div id="209" class="line none">  209     if( pHttpParser == NULL )</div><div id="210" class="line none">  210     {</div><div id="211" class="line none">  211         pHttpParser = malloc( sizeof( <a href="../../../source/dependency/3rdparty/llhttp/include/llhttp.h.html#324">llhttp_t</a> ) );</div><div id="212" class="line none">  212         __CPROVER_assume( pHttpParser != NULL );</div><div id="213" class="line none">  213     }</div><div id="214" class="line none">  214 </div><div id="215" class="line none">  215     pHttpParsingContext = <a href="http_cbmc_state.c.html#222">allocateHttpSendParsingContext</a>( NULL );</div><div id="216" class="line none">  216     __CPROVER_assume( <a href="http_cbmc_state.c.html#246">isValidHttpSendParsingContext</a>( pHttpParsingContext ) );</div><div id="217" class="line none">  217     pHttpParser-&gt;<a href="../../../source/dependency/3rdparty/llhttp/include/llhttp.h.html#28">data</a> = ( void * ) pHttpParsingContext;</div><div id="218" class="line none">  218 </div><div id="219" class="line none">  219     return pHttpParser;</div><div id="220" class="line none">  220 }</div><div id="221" class="line none">  221 </div><div id="222" class="line none">  222 <a href="../../../source/include/core_http_client_private.h.html#308">HTTPParsingContext_t</a> * <a href="http_cbmc_state.c.html#222">allocateHttpSendParsingContext</a>( <a href="../../../source/include/core_http_client_private.h.html#308">HTTPParsingContext_t</a> * pHttpParsingContext )</div><div id="223" class="line none">  223 {</div><div id="224" class="line none">  224     <a href="../../../source/include/core_http_client.h.html#584">HTTPResponse_t</a> * <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>;</div><div id="225" class="line none">  225     size_t bufferOffset;</div><div id="226" class="line none">  226 </div><div id="227" class="line none">  227     if( pHttpParsingContext == NULL )</div><div id="228" class="line none">  228     {</div><div id="229" class="line none">  229         pHttpParsingContext = malloc( sizeof( <a href="../../../source/include/core_http_client_private.h.html#308">HTTPParsingContext_t</a> ) );</div><div id="230" class="line none">  230         __CPROVER_assume( pHttpParsingContext != NULL );</div><div id="231" class="line none">  231 </div><div id="232" class="line none">  232         <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a> = <a href="http_cbmc_state.c.html#105">allocateHttpResponse</a>( NULL );</div><div id="233" class="line none">  233         __CPROVER_assume( <a href="http_cbmc_state.c.html#162">isValidHttpResponse</a>( <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a> ) &amp;&amp;</div><div id="234" class="line none">  234                           <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a> != NULL &amp;&amp;</div><div id="235" class="line none">  235                           <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#380">pBuffer</a> != NULL &amp;&amp;</div><div id="236" class="line none">  236                           <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#381">bufferLen</a> &gt; 0 );</div><div id="237" class="line none">  237         pHttpParsingContext-&gt;<a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a> = <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>;</div><div id="238" class="line none">  238 </div><div id="239" class="line none">  239         __CPROVER_assume( bufferOffset &lt; <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#381">bufferLen</a> );</div><div id="240" class="line none">  240         pHttpParsingContext-&gt;<a href="../../../source/include/core_http_client_private.h.html#303">pBufferCur</a> = <a href="../../../source/include/core_http_client_private.h.html#300">pResponse</a>-&gt;<a href="../../../source/include/core_http_client.h.html#380">pBuffer</a> + bufferOffset;</div><div id="241" class="line none">  241     }</div><div id="242" class="line none">  242 </div><div id="243" class="line none">  243     return pHttpParsingContext;</div><div id="244" class="line none">  244 }</div><div id="245" class="line none">  245 </div><div id="246" class="line none">  246 bool <a href="http_cbmc_state.c.html#246">isValidHttpSendParsingContext</a>( const <a href="../../../source/include/core_http_client_private.h.html#308">HTTPParsingContext_t</a> * pHttpParsingContext )</div><div id="247" class="line none">  247 {</div><div id="248" class="line none">  248     bool isValid = true;</div><div id="249" class="line none">  249 </div><div id="250" class="line none">  250     isValid = isValid &amp;&amp; ( pHttpParsingContext-&gt;<a href="../../../source/include/core_http_client_private.h.html#305">lastHeaderFieldLen</a> ) &lt;= ( SIZE_MAX - CBMC_MAX_OBJECT_SIZE );</div><div id="251" class="line none">  251     isValid = isValid &amp;&amp; ( pHttpParsingContext-&gt;<a href="../../../source/include/core_http_client_private.h.html#307">lastHeaderValueLen</a> ) &lt;= ( SIZE_MAX - CBMC_MAX_OBJECT_SIZE );</div><div id="252" class="line none">  252 </div><div id="253" class="line none">  253     return isValid;</div><div id="254" class="line none">  254 }</div><div id="255" class="line none">  255 </div><div id="256" class="line none">  256 <a href="../../../source/dependency/3rdparty/llhttp/include/llhttp.h.html#324">llhttp_t</a> * <a href="http_cbmc_state.c.html#256">allocateHttpReadHeaderParser</a>( <a href="../../../source/dependency/3rdparty/llhttp/include/llhttp.h.html#324">llhttp_t</a> * pHttpParser )</div><div id="257" class="line none">  257 {</div><div id="258" class="line none">  258     <a href="../../../source/include/core_http_client_private.h.html#308">HTTPParsingContext_t</a> * pFindHeaderContext;</div><div id="259" class="line none">  259 </div><div id="260" class="line none">  260     if( pHttpParser == NULL )</div><div id="261" class="line none">  261     {</div><div id="262" class="line none">  262         pHttpParser = malloc( sizeof( <a href="../../../source/dependency/3rdparty/llhttp/include/llhttp.h.html#324">llhttp_t</a> ) );</div><div id="263" class="line none">  263         __CPROVER_assume( pHttpParser != NULL );</div><div id="264" class="line none">  264     }</div><div id="265" class="line none">  265 </div><div id="266" class="line none">  266     pFindHeaderContext = <a href="http_cbmc_state.c.html#272">allocateFindHeaderContext</a>( NULL );</div><div id="267" class="line none">  267     pHttpParser-&gt;<a href="../../../source/dependency/3rdparty/llhttp/include/llhttp.h.html#28">data</a> = ( void * ) pFindHeaderContext;</div><div id="268" class="line none">  268 </div><div id="269" class="line none">  269     return pHttpParser;</div><div id="270" class="line none">  270 }</div><div id="271" class="line none">  271 </div><div id="272" class="line none">  272 <a href="../../../source/include/core_http_client_private.h.html#230">findHeaderContext_t</a> * <a href="http_cbmc_state.c.html#272">allocateFindHeaderContext</a>( <a href="../../../source/include/core_http_client_private.h.html#230">findHeaderContext_t</a> * pFindHeaderContext )</div><div id="273" class="line none">  273 {</div><div id="274" class="line none">  274     if( pFindHeaderContext == NULL )</div><div id="275" class="line none">  275     {</div><div id="276" class="line none">  276         pFindHeaderContext = malloc( sizeof( <a href="../../../source/include/core_http_client_private.h.html#230">findHeaderContext_t</a> ) );</div><div id="277" class="line none">  277         __CPROVER_assume( pFindHeaderContext != NULL );</div><div id="278" class="line none">  278     }</div><div id="279" class="line none">  279 </div><div id="280" class="line none">  280     return pFindHeaderContext;</div><div id="281" class="line none">  281 }</div>
</div>
</body>
</html>
