/*
 * CBMC Harness generated for example.c
 * Generated by: claude
 * Generated at: 2025-02-03 21:03:50
 */

#include <stdint.h>
#include <stdbool.h>

/* FreeRTOS includes */
#include "FreeRTOS.h"
#include "task.h"
#include "queue.h"
#include "semphr.h"

/* Stub required FreeRTOS headers */
void vTaskDelayUntil(TickType_t *pxPreviousWakeTime, TickType_t xTimeIncrement) {}
void vTaskDelete(TaskHandle_t xTaskToDelete) {}
TickType_t xTaskGetTickCount(void) { return __CPROVER_nondet_ulong(); }

/* Declare the functions to be verified */
static uint32_t ulGetSensorReading(void);
static void vProcessSensorData(const SensorData_t* pxData);
bool initSystem(void);

/* Verification harness */
int main() {
    /* Assume FreeRTOS is properly initialized */
    __CPROVER_assume(configASSERT(pdTRUE));

    /* Non-deterministic inputs */
    uint32_t nondet_temp = __CPROVER_nondet_uint();
    __CPROVER_assume(nondet_temp >= MIN_TEMPERATURE && nondet_temp <= MAX_TEMPERATURE);
    
    SensorData_t *nondet_data = malloc(sizeof(SensorData_t));
    __CPROVER_assume(nondet_data != NULL);
    nondet_data->temperature = nondet_temp;
    nondet_data->timestamp = __CPROVER_nondet_uint();

    /* Verify sensor reading */
    uint32_t sensor_value = ulGetSensorReading();
    assert(sensor_value >= MIN_TEMPERATURE && sensor_value <= MAX_TEMPERATURE);

    /* Verify sensor data processing */
    vProcessSensorData(nondet_data);
    vProcessSensorData(NULL);
    free(nondet_data);

    /* Verify system initialization */
    bool init_success = initSystem();
    
    if (init_success) {
        /* Verify task creation */
        __CPROVER_assert(xSensorTaskHandle != NULL, "Sensor task creation failed");
        __CPROVER_assert(xProcessTaskHandle != NULL, "Process task creation failed");
        
        /* Verify queue creation */
        __CPROVER_assert(xSensorQueue != NULL, "Sensor queue creation failed");
        __CPROVER_assert(uxQueueMessagesWaiting(xSensorQueue) == 0, "Sensor queue should be empty");
        
        /* Verify semaphore creation */  
        __CPROVER_assert(xSensorMutex != NULL, "Sensor mutex creation failed");
        __CPROVER_assert(uxSemaphoreGetCount(xSensorMutex) == 1, "Sensor mutex should be available");

        /* Cleanup resources */
        vSemaphoreDelete(xSensorMutex);
        vQueueDelete(xSensorQueue);
        vTaskDelete(xProcessTaskHandle);
        vTaskDelete(xSensorTaskHandle);
    }
    
    return 0;
}